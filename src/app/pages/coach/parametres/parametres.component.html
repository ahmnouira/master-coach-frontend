<app-sub-header [title]="'Paramètres'"></app-sub-header>
<div class="row sub-component-content">
  <div class="col-3 p-0">
    <app-coach-menu [active]="'profile'"></app-coach-menu>
  </div>
  <div class="col-9">
    <div class="row">
      <div class="col-12 ms-lg-0 col-lg-3 col-separator p-lg-0 mb-3 mb-lg-0">
        <span class="row-title">Informations personnelles</span>
      </div>
      <div class="col-12 col-lg-9 pl-40">
        <div class="image-container">
          <img
            class="profil-image"
            [attr.src]="form.photo"
            (click)="file.click()"
          />
          <input
            type="file"
            hidden
            accept="image/*"
            (change)="importFile($event)"
            #file
          />
          <button (click)="file.click()">
            <img
              class="profil-icon"
              src="assets/img/common/camera-to-take-photos%20(3).svg"
            />
          </button>
        </div>
        <div class="row profil-data mb-17 gx-4">
          <div class="col-md-6 form-group">
            <label class="element-label">Nom</label>
            <input
              type="text"
              [(ngModel)]="form.nom"
              class="form-control element"
              placeholder="Laroche"
            />
          </div>
          <div class="col-md-6 form-group">
            <label class="element-label">Prénom</label>
            <input
              type="text"
              [(ngModel)]="form.prenom"
              class="form-control element"
              placeholder="David"
            />
          </div>
        </div>
        <div class="row profil-data mb-17 gx-4">
          <div class="col-md-6 form-group">
            <label class="element-label">Email</label>
            <input
              type="email"
              [(ngModel)]="form.email"
              class="form-control element"
              placeholder="davidlaroche@gmail.com"
              pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
              required
              #email="ngModel"
            />
            <div *ngIf="(email.invalid && email.touched) || email.dirty">
              <small
                *ngIf="email.errors?.required"
                class="alert alert-danger"
                role="alert"
                >L'email' est obligatoire!</small
              >
              <small
                *ngIf="email.errors?.pattern"
                class="alert alert-danger"
                role="alert"
                >Veuillez entrer un email valide</small
              >
            </div>
          </div>

          <div class="col-md-6 form-group">
            <label class="element-label">Numéro de téléphone</label>
            <input
              type="tel"
              [(ngModel)]="form.tel"
              class="form-control element"
              placeholder="+33 12 34 56 789"
              pattern="^(0|\+33)[ ]?[1-9]([-.: ]?[0-9]{2}){4}$"
              required
              #tel="ngModel"
            />
            <div *ngIf="(tel.invalid && email.touched) || tel.dirty">
              <small
                *ngIf="tel.errors?.required"
                class="alert alert-danger"
                role="alert"
                >Le numéro de telephone est est obligatoire!</small
              >
              <small
                *ngIf="tel.errors?.pattern"
                class="alert alert-danger"
                role="alert"
                >Veuillez entrer un numéro de telephone valide</small
              >
            </div>
          </div>
        </div>
        <div class="row profil-data">
          <div class="form-group col-md-12">
            <label class="element-label">Biographie</label>
            <textarea
              rows="5"
              style="height: 120px"
              [(ngModel)]="form.bio"
              class="form-control element"
              placeholder="davidlaroche@gmail.com"
            >
Praesent congue commodo sapien eget sodales. Vestibulum facilisis convallis massa, id porta turpis euismod a. Aliquam vitae orci semper, lacinia orci nec, tristique risus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Quisque fermentum purus leo, vestibulum laoreet tortor aliquam et. Vestibulum fringilla scelerisque faucibus. Nullam a elit eu nisl suscipit tempor sit amet eu erat. Morbi odio lorem.
</textarea
            >
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div
        class="center-verticaly col-12 ms-lg-0 col-lg-3 col-separator p-lg-0 mb-3 mb-lg-0"
      >
        <span class="row-title">Documents</span>
      </div>

      <div class="col-lg-9 col-12 pl-40">
        <div class="row profil-data mb-17 gx-4">
          <!-- CIN  Front -->
          <div *ngIf="!form.cinF" class="col-md-6 form-group">
            <label class="element-label">C.N.I Front</label>

            <div class="file-input">
              <input
                type="file"
                required
                class="form-control form-control-lg element"
                style="display: none"
                id="cinF"
                title=" "
                name="cinF"
                accept="application/pdf"
                (change)="importCINFront($event)"
              />
              <label for="cinF">
                <app-import-icon></app-import-icon>
                Choisir un fichier</label
              >
            </div>
          </div>

          <div *ngIf="form.cinF" class="col-md-6 file-box">
            <label class="element-label" for="cinF">C.N.I Front</label>
            <div class="d-flex">
              <a
                class="mlr-10"
                [attr.href]="
                  sanitizer.bypassSecurityTrustResourceUrl(form.cinF)
                "
                download="cinF-{{ form.nom }}-{{ form.prenom }}.pdf"
                title="cinF-{{ form.nom }}-{{ form.prenom }}.pdf"
                >cinF-{{ form.nom }}-{{ form.prenom }}.pdf</a
              >
              <img
                (click)="form.cinF = ''"
                src="assets/img/common/trash-bin.svg"
                style="width: 15px"
              />
            </div>
          </div>

          <!-- 
          <app-file-imported
            *ngIf="form.cinF"
            [label]="C.N.I Front"
            [name]="cinF"
            [sanitizer]="{{form.cinF}}"
            [title]="cin-{{ form.nom }}-{{ form.prenom }}.pdf"
          >
          </app-file-imported>
          -->

          <!-- CIN  Back -->
          <div *ngIf="!form.cinB" class="col-md-6 form-group">
            <label class="element-label">C.N.I Back</label>

            <div class="file-input">
              <input
                type="file"
                required
                class="form-control form-control-lg element"
                style="display: none"
                id="cinB"
                title=" "
                name="cinB"
                accept="application/pdf"
                (change)="importCINBack($event)"
              />
              <label for="cinB">
                <app-import-icon></app-import-icon>
                Choisir un fichier</label
              >
            </div>
          </div>

          <div *ngIf="form.cinB" class="col-md-6 file-box">
            <label class="element-label" for="cinF">C.N.I Back</label>
            <div class="d-flex">
              <a
                class="mlr-10"
                [attr.href]="
                  sanitizer.bypassSecurityTrustResourceUrl(form.cinB)
                "
                download="cinB-{{ form.nom }}-{{ form.prenom }}.pdf"
                title="cinB-{{ form.nom }}-{{ form.prenom }}.pdf"
                >cinB-{{ form.nom }}-{{ form.prenom }}.pdf</a
              >
              <img
                (click)="form.cinB = ''"
                src="assets/img/common/trash-bin.svg"
                style="width: 15px"
              />
            </div>
          </div>
        </div>

        <div class="row profil-data mb-17 gx-4">
          <div *ngIf="!form.kbis" class="col-md-6 form-group">
            <label class="element-label">KBIS</label>
            <div class="file-input">
              <input
                type="file"
                required
                class="form-control form-control-lg element"
                id="kbis"
                style="display: none"
                name="kbis"
                accept="application/pdf"
                (change)="importKbis($event)"
              />

              <label for="kbis">
                <app-import-icon></app-import-icon>
                Choisir un fichier</label
              >
            </div>
          </div>
          <div *ngIf="form.kbis" class="col-md-6 file-box">
            <label class="element-label" for="kbis">KBIS</label>
            <div class="d-flex">
              <a
                class="mlr-10 element"
                [attr.href]="
                  sanitizer.bypassSecurityTrustResourceUrl(form.kbis)
                "
                download="kbis-{{ form.nom }}-{{ form.prenom }}.pdf"
                title="kbis-{{ form.nom }}-{{ form.prenom }}.pdf"
                >kbis-{{ form.nom }}-{{ form.prenom }}.pdf</a
              >
              <img
                (click)="form.kbis = ''"
                src="assets/img/common/trash-bin.svg"
                style="width: 15px"
              />
            </div>
          </div>
        </div>

        <!-- End KBIS-->

        <div class="row d-flex profil-data gx-4">
          <div class="form-group col-md-6">
            <label class="element-label" for="urssaf">URSSAF</label>
            <input
              type="text"
              class="form-control element"
              id="urssaf"
              name="urssaf"
              placeholder="XXXXXXXXXX"
              [(ngModel)]="form.urssaf"
              required
            />
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div
        class="col-12 ms-lg-0 col-lg-3 col-separator p-lg-0 mb-3 mb-lg-0 center-verticaly"
      >
        <span class="row-title">Spécialisation</span>
      </div>
      <div class="col-lg-9 col-12 pl-40">
        <div class="row profil-data mb-17 gx-4">
          <div class="col-md-6 form-group">
            <label class="element-label">Catégorie</label>
            <angular2-multiselect
              name="category"
              [data]="userCategory"
              [(ngModel)]="form.category"
              [settings]="settings"
            >
            </angular2-multiselect>
          </div>
          <div class="col-md-6 form-group">
            <label class="element-label">Compétences</label>
            <angular2-multiselect
              name="competance"
              [data]="userCompetences"
              [(ngModel)]="form.competance"
              [settings]="settings"
            >
            </angular2-multiselect>
          </div>
        </div>
        <div class="row profil-data">
          <div class="col-md-6 form-group gx-4">
            <label class="element-label">Accreditations</label>
            <angular2-multiselect
              name="accreditations"
              [data]="userAccred"
              [(ngModel)]="form.accreditation"
              [settings]="settings"
            >
            </angular2-multiselect>
          </div>
        </div>
      </div>
    </div>
    <div class="row mt-4">
      <div
        class="col-12 ms-lg-0 col-lg-3 mb-3 p-lg-0 col-margin center-verticaly"
      >
        <span class="row-title">Mise à jour du mot de passe</span>
      </div>
      <div class="col-lg-9 col-12 pl-40">
        <div class="row gx-4 profil-data">
          <div class="col-md-6 form-group">
            <label class="element-label">Nouveau mot de passe</label>
            <input
              type="password"
              [(ngModel)]="newPassword"
              id="password"
              (click)="passwordChanged()"
              class="form-control element"
              name="password"
              #password
            />
          </div>
          <div class="col-md-6 form-group">
            <label class="element-label"
              >Confirmez le nouveau mot de passe</label
            >
            <input
              type="password"
              [(ngModel)]="confirmPassword"
              (click)="confirmPasswordChanged()"
              class="form-control element"
              [required]="password.value.length > 0"
              pattern="{{ password.value }}"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-3 col-12 p-0 hidden-md col-margin"></div>
      <div class="col-lg-9 col-12 mt-20 pl-40">
        <button class="btn btn-primary align-self-end" (click)="saveUser()">
          Enregistrer</button
        >&nbsp;
      </div>
    </div>
  </div>
</div>
